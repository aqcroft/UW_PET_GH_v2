<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UW Earnings Potential Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @keyframes slideDown {
            0% { opacity: 0; transform: scale(0.95); }
            100% { opacity: 1; transform: scale(1); }
        }
        @keyframes confetti {
            0% { transform: translateY(0) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }
        @keyframes bounceOnce {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-20px); }
            50% { transform: translateY(0); }
            75% { transform: translateY(-10px); }
        }
        @keyframes gentlePulse {
            0%, 100% { transform: scale(1); }
            33% { transform: scale(1.05); }
            66% { transform: scale(1); }
        }
        @keyframes pulseGlow {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 rgba(147, 51, 234, 0); }
            33% { transform: scale(1.05); box-shadow: 0 0 20px rgba(147, 51, 234, 0.6); }
            66% { transform: scale(1); box-shadow: 0 0 0 rgba(147, 51, 234, 0); }
        }
        .animate-slideDown { animation: slideDown 0.2s ease-out forwards; }
        .animate-confetti { animation: confetti 3s ease-in forwards; }
        .animate-bounceOnce { animation: bounceOnce 0.6s ease-in-out; }
        .animate-gentlePulse { animation: gentlePulse 1.5s ease-in-out 3; }
        .animate-pulseGlow { animation: pulseGlow 1.5s ease-in-out 3; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const RefreshCw = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
            </svg>
        );

        const TrendingUp = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
            </svg>
        );

        const Lock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
            </svg>
        );

        const Unlock = ({ className }) => (
            <svg className={className} fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M8 11V7a4 4 0 118 0m-4 8v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2z" />
            </svg>
        );

        const UWTracker = () => {
            const [mode, setMode] = useState('opportunity');
            const [showCelebration, setShowCelebration] = useState(false);
            const [showResetConfirm, setShowResetConfirm] = useState(false);
            const [showWIP1, setShowWIP1] = useState(false);
            const [showWIP2, setShowWIP2] = useState(false);
            
            const [opportunityData, setOpportunityData] = useState({
                selectedCircle: null,
                showPartnerPrompt: false,
                previouslyQualified: false,
                customers: [
                    { type: 'own', services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false }
                ]
            });
            
            const [trackData, setTrackData] = useState({
                selectedCircle: null,
                showPartnerPrompt: false,
                showPartnerPopup: false,
                showIncomeStreamsPopup: false,
                previouslyQualified: false,
                qdExpanded: false,
                qd6Expanded: false,
                qdPulsed: false,
                qd6Pulsed: false,
                customers: [
                    { type: 'own', services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false },
                    { type: null, services: 0, isPartner: false }
                ]
            });
            const currentData = mode === 'opportunity' ? opportunityData : trackData;
            const setCurrentData = mode === 'opportunity' ? setOpportunityData : setTrackData;
            const { selectedCircle, showPartnerPrompt, showPartnerPopup, showIncomeStreamsPopup, previouslyQualified, qdExpanded, qd6Expanded, qdPulsed, qd6Pulsed, customers } = currentData;

            const calculateCB = (customer) => {
                if (customer.type === 'own' || customer.type === 'renting') return 0;
                if (customer.type === 'homeowner') {
                    if (customer.services === 1) return 50;
                    if (customer.services === 2) return 100;
                    if (customer.services === 3) return 250;
                    if (customer.services === 4) return 300;
                }
                return 0;
            };

            const highActivityCustomers = customers.filter((c, i) => i > 0 && c.type === 'homeowner' && (c.services === 3 || c.services === 4)).length;
            const habPerCustomer = highActivityCustomers >= 2 ? (highActivityCustomers >= 4 ? 100 : 50) : 0;
            const totalHAB = highActivityCustomers * habPerCustomer;

            const totalCB = customers.reduce((sum, c) => sum + calculateCB(c), 0);
            const hasPartner = customers.some((c, i) => i > 0 && c.isPartner);
            const allCirclesFilled = customers.every(c => c.type !== null);
            const filledCustomers = customers.filter((c, i) => i > 0 && c.type !== null).length;
            const qualifiesForFastStart = allCirclesFilled && hasPartner;
            const fastStartBonus = qualifiesForFastStart ? 500 : 0;
            const grandTotal = totalCB + totalHAB + fastStartBonus;
            
            const tenantCount = customers.filter((c, i) => i > 0 && c.type === 'renting').length;
            const residualIncome = tenantCount * 2.5;

            const qdUnlocked = filledCustomers >= 2;
            const qd6Unlocked = filledCustomers >= 5;

            useEffect(() => {
                if (mode === 'track' && qdUnlocked && !qdPulsed) {
                    const timer = setTimeout(() => {
                        setCurrentData(prev => ({ ...prev, qdPulsed: true }));
                    }, 4500);
                    return () => clearTimeout(timer);
                }
            }, [qdUnlocked, qdPulsed, mode]);

            useEffect(() => {
                if (mode === 'track' && qd6Unlocked && !qd6Pulsed) {
                    const timer = setTimeout(() => {
                        setCurrentData(prev => ({ ...prev, qd6Pulsed: true }));
                    }, 4500);
                    return () => clearTimeout(timer);
                }
            }, [qd6Unlocked, qd6Pulsed, mode]);

            const getCircleOpacity = (index) => {
                if (index === 0) return 1;
                for (let i = 1; i < index; i++) {
                    if (customers[i].type === null) return 0.3;
                }
                if (customers[index].type !== null) return 1;
                return 1;
            };

            const canSelectCircle = (index) => {
                if (index === 0) return false;
                if (allCirclesFilled) return true;
                for (let i = 1; i < index; i++) {
                    if (customers[i].type === null) return false;
                }
                return true;
            };

            const handlePartnerBadgeClick = (e, index) => {
                e.stopPropagation();
                if (index === 0 || customers[index].type === null) return;
                if (filledCustomers < 5) return;
                
                const wasQualified = qualifiesForFastStart;
                const newCustomers = [...customers];
                newCustomers[index].isPartner = !newCustomers[index].isPartner;
                setCurrentData({ ...currentData, customers: newCustomers, showPartnerPrompt: false });
                
                const nowAllFilled = newCustomers.every(c => c.type !== null);
                const nowHasPartner = newCustomers.some((c, i) => i > 0 && c.isPartner);
                const nowQualifies = nowAllFilled && nowHasPartner;
                
                if (!wasQualified && nowQualifies && !previouslyQualified) {
                    setCurrentData({ ...currentData, customers: newCustomers, previouslyQualified: true, showPartnerPrompt: false });
                    setTimeout(() => {
                        setShowCelebration(true);
                        setTimeout(() => setShowCelebration(false), 3000);
                    }, 200);
                }
                
                if (!nowQualifies) {
                    setCurrentData({ ...currentData, customers: newCustomers, previouslyQualified: false, showPartnerPrompt: false });
                }
            };

            const handleCircleClick = (index) => {
                if (index === 0 || !canSelectCircle(index)) return;
                setCurrentData({ ...currentData, selectedCircle: index });
            };

            const setCustomerType = (type, services = 0) => {
                if (selectedCircle === null) return;
                
                const wasQualified = qualifiesForFastStart;
                const newCustomers = [...customers];
                newCustomers[selectedCircle] = { type, services, isPartner: newCustomers[selectedCircle].isPartner };
                
                const nowAllFilled = newCustomers.every(c => c.type !== null);
                const nowHasPartner = newCustomers.some((c, i) => i > 0 && c.isPartner);
                const nowQualifies = nowAllFilled && nowHasPartner;
                
                if (!wasQualified && nowQualifies && !previouslyQualified) {
                    setCurrentData({ ...currentData, customers: newCustomers, selectedCircle: null, previouslyQualified: true });
                    setTimeout(() => {
                        setShowCelebration(true);
                        setTimeout(() => setShowCelebration(false), 3000);
                    }, 200);
                } else if (nowAllFilled && !nowHasPartner) {
                    setCurrentData({ ...currentData, customers: newCustomers, selectedCircle: null, showPartnerPrompt: true });
                } else {
                    setCurrentData({ ...currentData, customers: newCustomers, selectedCircle: null });
                }
                
                if (!nowQualifies) {
                    setCurrentData(prev => ({ ...prev, previouslyQualified: false }));
                }
            };

            const removeCustomer = () => {
                if (selectedCircle === null) return;
                const newCustomers = [...customers];
                newCustomers[selectedCircle] = { type: null, services: 0, isPartner: false };
                setCurrentData({ ...currentData, customers: newCustomers, selectedCircle: null });
                
                const nowQualifies = newCustomers.every(c => c.type !== null) && newCustomers.some((c, i) => i > 0 && c.isPartner);
                if (!nowQualifies) {
                    setCurrentData(prev => ({ ...prev, previouslyQualified: false }));
                }
            };

            const resetTracking = () => {
                const resetState = {
                    selectedCircle: null,
                    showPartnerPrompt: false,
                    showPartnerPopup: false,
                    showIncomeStreamsPopup: false,
                    previouslyQualified: false,
                    qdExpanded: false,
                    qd6Expanded: false,
                    qdPulsed: false,
                    qd6Pulsed: false,
                    customers: [
                        { type: 'own', services: 0, isPartner: false },
                        { type: null, services: 0, isPartner: false },
                        { type: null, services: 0, isPartner: false },
                        { type: null, services: 0, isPartner: false },
                        { type: null, services: 0, isPartner: false },
                        { type: null, services: 0, isPartner: false }
                    ]
                };
                
                if (mode === 'opportunity') {
                    setOpportunityData(resetState);
                } else {
                    setTrackData(resetState);
                }
                setShowResetConfirm(false);
            };

            const renderCircle = (customer, index) => (
                <div key={index} className="flex flex-col items-center relative">
                    <div 
                        onClick={() => handleCircleClick(index)} 
                        style={{ opacity: getCircleOpacity(index) }} 
                        className={`w-20 h-20 rounded-full border-4 flex flex-col items-center justify-center text-lg font-bold transition-all relative ${
                            customer.type === null 
                                ? 'border-gray-300 text-gray-400 bg-gray-50' 
                                : customer.type === 'own' 
                                ? 'border-gray-400 text-gray-700 bg-gray-100' 
                                : customer.type === 'renting' 
                                ? 'border-blue-600 text-blue-700 bg-blue-50' 
                                : 'border-purple-600 text-purple-700 bg-purple-50'
                        } ${
                            index > 0 && selectedCircle === index ? 'ring-4 ring-purple-300' : ''
                        } ${
                            canSelectCircle(index) ? 'cursor-pointer hover:scale-105' : 'cursor-not-allowed'
                        }`}
                    >
                        {index === 0 ? (
                            <span className="text-lg font-bold">You</span>
                        ) : customer.type ? (
                            <>
                                <span className="text-sm font-bold">¬£{calculateCB(customer).toLocaleString()}</span>
                                {customer.type === 'homeowner' && (customer.services === 3 || customer.services === 4) && highActivityCustomers >= 2 && (
                                    <div className="absolute -top-1 -right-1 px-1 py-0.5 bg-orange-500 text-white text-xs font-bold rounded z-[5]">
                                        +¬£{habPerCustomer}
                                    </div>
                                )}
                                <div 
                                    onClick={(e) => handlePartnerBadgeClick(e, index)} 
                                    className={`absolute -bottom-1 -right-1 w-6 h-6 rounded-full border-2 flex items-center justify-center z-[5] transition-transform ${
                                        filledCustomers >= 5 
                                            ? 'cursor-pointer hover:scale-110' 
                                            : 'cursor-not-allowed opacity-50'
                                    } ${
                                        customer.isPartner 
                                            ? 'bg-yellow-400 border-yellow-600' 
                                            : 'bg-gray-200 border-gray-400 hover:border-yellow-500'
                                    }`}
                                >
                                    <span className={`text-xs font-bold ${customer.isPartner ? 'text-yellow-900' : 'text-gray-500'}`}>
                                        P
                                    </span>
                                </div>
                            </>
                        ) : (
                            <>
                                {index === 1 ? '2nd' : index === 2 ? '3rd' : `${index + 1}th`}
                                <div className="absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-gray-200 border-2 border-gray-400 flex items-center justify-center z-[5] opacity-50">
                                    <span className="text-xs font-bold text-gray-500">P</span>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
            return (
                <div className="min-h-screen bg-gradient-to-br from-pink-50 to-purple-50 p-4 md:p-8">
                    {showCelebration && (
                        <div className="fixed inset-0 pointer-events-none z-50">
                            {[...Array(50)].map((_, i) => (
                                <div key={i} className="absolute animate-confetti" style={{ left: `${Math.random() * 100}%`, top: '-10%', animationDelay: `${Math.random() * 0.5}s`, animationDuration: `${2 + Math.random() * 1}s` }}>
                                    <div className="text-yellow-400" style={{ fontSize: `${Math.random() * 20 + 10}px`, transform: `rotate(${Math.random() * 360}deg)` }}>‚ú®</div>
                                </div>
                            ))}
                        </div>
                    )}
                    
                    <div className="max-w-2xl mx-auto">
                        <div className="text-center mb-4">
                            <h1 className="text-2xl md:text-3xl font-bold text-gray-800 mb-2">UW Earnings Potential Tool</h1>
                            <p className="text-sm md:text-base text-gray-600 mb-3">Explore what five customers could earn you in the first 30 days</p>
                            
                            <div className="flex justify-between items-center">
                                {mode === 'opportunity' ? (
                                    <>
                                        <button
                                            onClick={() => setShowWIP1(true)}
                                            className="flex items-center gap-2 group"
                                        >
                                            <div className="relative w-12 h-6 bg-teal-300 rounded-full transition-all group-hover:bg-teal-400">
                                                <div className="absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transition-all"></div>
                                            </div>
                                            <span className="text-xs font-semibold text-teal-700">You</span>
                                        </button>

                                        <div className="inline-flex rounded-lg border-2 border-purple-300 overflow-hidden">
                                            <button
                                                onClick={() => setMode('opportunity')}
                                                className={`px-4 py-2 text-sm font-semibold transition-all ${
                                                    mode === 'opportunity'
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-white text-gray-700 hover:bg-purple-50'
                                                }`}
                                            >
                                                Show
                                            </button>
                                            <button
                                                onClick={() => setMode('track')}
                                                className={`px-4 py-2 text-sm font-semibold transition-all ${
                                                    mode === 'track'
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-white text-gray-700 hover:bg-purple-50'
                                                }`}
                                            >
                                                Explore
                                            </button>
                                        </div>

                                        <div className="w-[76px]"></div>
                                    </>
                                ) : (
                                    <>
                                        <button
                                            onClick={() => setShowWIP1(true)}
                                            className="flex items-center gap-2 group"
                                        >
                                            <div className="relative w-12 h-6 bg-teal-300 rounded-full transition-all group-hover:bg-teal-400">
                                                <div className="absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transition-all"></div>
                                            </div>
                                            <span className="text-xs font-semibold text-teal-700">You</span>
                                        </button>

                                        <div className="inline-flex rounded-lg border-2 border-purple-300 overflow-hidden">
                                            <button
                                                onClick={() => setMode('opportunity')}
                                                className={`px-4 py-2 text-sm font-semibold transition-all ${
                                                    mode === 'opportunity'
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-white text-gray-700 hover:bg-purple-50'
                                                }`}
                                            >
                                                Show
                                            </button>
                                            <button
                                                onClick={() => setMode('track')}
                                                className={`px-4 py-2 text-sm font-semibold transition-all ${
                                                    mode === 'track'
                                                        ? 'bg-purple-600 text-white'
                                                        : 'bg-white text-gray-700 hover:bg-purple-50'
                                                }`}
                                            >
                                                Explore
                                            </button>
                                        </div>

                                        <button
                                            onClick={() => setShowWIP2(true)}
                                            className="flex items-center gap-2 group"
                                        >
                                            <span className="text-xs font-semibold text-teal-700">CB Calc</span>
                                            <div className="relative w-12 h-6 bg-teal-300 rounded-full transition-all group-hover:bg-teal-400">
                                                <div className="absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full shadow-md transition-all"></div>
                                            </div>
                                        </button>
                                    </>
                                )}
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-lg p-6 md:p-8">
                            {mode === 'opportunity' ? (
                                <>
                                    <div className="grid grid-cols-3 gap-4 mb-4">
                                        {customers.map((customer, index) => renderCircle(customer, index))}
                                    </div>
                                    
                                    {allCirclesFilled && !hasPartner && (
                                        <div className="mb-4 bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-lg p-4 border-2 border-yellow-600">
                                            <div className="flex items-center justify-center gap-3">
                                                <p className="text-lg font-bold text-yellow-900">Upgrade one customer to partner: just press a</p>
                                                <div className="w-8 h-8 rounded-full bg-gray-200 border-2 border-gray-400 flex items-center justify-center">
                                                    <span className="text-sm font-bold text-gray-500">P</span>
                                                </div>
                                                <span className="text-2xl text-yellow-900">‚Üí</span>
                                                <div className="w-8 h-8 rounded-full bg-yellow-400 border-2 border-yellow-600 flex items-center justify-center">
                                                    <span className="text-sm font-bold text-yellow-900">P</span>
                                                </div>
                                            </div>
                                        </div>
                                    )}
                                </>
                            ) : (
                                <div className="mb-6">
                                    <div className="grid grid-cols-3 gap-4 mb-3">
                                        {customers.slice(0, 3).map((customer, index) => renderCircle(customer, index))}
                                    </div>

                                    <div className="mb-4">
                                        <div
                                            onClick={() => qdUnlocked && setCurrentData({ ...currentData, qdExpanded: !qdExpanded, qd6Expanded: false })}
                                            className={`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border-2 transition-all ${
                                                qdUnlocked
                                                    ? 'bg-purple-50 border-purple-400 cursor-pointer hover:bg-purple-100'
                                                    : 'bg-gray-50 border-gray-200 cursor-not-allowed opacity-60'
                                            } ${qdUnlocked && !qdPulsed ? 'animate-gentlePulse' : ''}`}
                                        >
                                            {qdUnlocked ? <Unlock className="w-4 h-4 text-purple-600" /> : <Lock className="w-4 h-4 text-gray-400" />}
                                            <span className={`text-sm font-semibold ${qdUnlocked ? 'text-purple-700' : 'text-gray-500'}`}>
                                                {qdUnlocked ? 'QD Promotion! New Revenue Stream unlocked (Tap for details)' : 'QD Unlock (3 customers needed)'}
                                            </span>
                                        </div>
                                    </div>

                                    <div className="grid grid-cols-3 gap-4 mb-3">
                                        {customers.slice(3, 6).map((customer, index) => renderCircle(customer, index + 3))}
                                    </div>

                                    <div>
                                        <div
                                            onClick={() => qd6Unlocked && setCurrentData({ ...currentData, qd6Expanded: !qd6Expanded, qdExpanded: false })}
                                            className={`flex items-center justify-center gap-2 py-2 px-4 rounded-lg border-2 transition-all ${
                                                qd6Unlocked
                                                    ? 'bg-purple-50 border-purple-400 cursor-pointer hover:bg-purple-100'
                                                    : 'bg-gray-50 border-gray-200 cursor-not-allowed opacity-60'
                                            } ${qd6Unlocked && !qd6Pulsed ? 'animate-pulseGlow' : ''}`}
                                        >
                                            {qd6Unlocked ? <Unlock className="w-4 h-4 text-purple-600" /> : <Lock className="w-4 h-4 text-gray-400" />}
                                            <span className={`text-sm font-semibold ${qd6Unlocked ? 'text-purple-700' : 'text-gray-500'}`}>
                                                {qd6Unlocked ? '6 customers! 3 New Revenue Streams unlocked (Tap for details)' : '6 Customer Unlock (6 customers needed)'}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            )}

                            <div className="space-y-3">
                                <div className={`flex justify-between items-center py-3 px-4 rounded-lg border-4 transition-all ${totalCB > 0 ? 'bg-purple-50 border-purple-600' : 'bg-gray-50 border-gray-300'}`}>
                                    <div className="flex items-center gap-2">
                                        <span className={`text-xl ${totalCB > 0 ? '' : 'grayscale opacity-40'}`}>üí∑</span>
                                        <span className={`font-semibold ${totalCB > 0 ? 'text-purple-600' : 'text-gray-600'}`}>Customer Bonus:</span>
                                    </div>
                                    <span className={`text-xl font-bold ${totalCB > 0 ? 'text-purple-700' : 'text-gray-400'}`}>¬£{totalCB.toLocaleString()}</span>
                                </div>

                                {highActivityCustomers >= 2 && (
                                    <div className="flex justify-between items-center py-3 px-4 rounded-lg border-4 bg-orange-50 border-orange-500 transition-all">
                                        <div className="flex items-center gap-2">
                                            <span className="text-xl">üî•</span>
                                            <span className="font-semibold text-orange-600">High Activity Bonus:</span>
                                        </div>
                                        <span className="text-xl font-bold text-orange-600">¬£{totalHAB.toLocaleString()}</span>
                                    </div>
                                )}
                                
                                <div className={`flex justify-between items-center py-3 px-4 rounded-lg transition-all ${qualifiesForFastStart ? 'bg-green-50 border-2 border-green-300' : 'bg-gray-50 border-2 border-gray-200'}`}>
                                    <div className="flex items-center gap-2">
                                        <TrendingUp className={`w-5 h-5 ${qualifiesForFastStart ? 'text-green-600' : 'text-gray-400'}`} />
                                        <span className={`font-semibold ${qualifiesForFastStart ? 'text-green-600' : 'text-gray-700'}`}>Fast Start Bonus:</span>
                                    </div>
                                    <span className={`text-xl font-bold ${qualifiesForFastStart ? 'text-green-600' : 'text-gray-400'}`}>¬£{fastStartBonus.toLocaleString()}</span>
                                </div>

                                <div className="flex justify-between items-center py-4 px-4 rounded-lg shadow-md text-white relative overflow-hidden">
                                    <div className="absolute inset-0" style={{ background: qualifiesForFastStart ? `linear-gradient(to right, rgb(147, 51, 234) 0%, rgb(147, 51, 234) ${(totalCB / grandTotal) * 100}%, rgb(198, 83, 140) ${(totalCB / grandTotal) * 100}%, rgb(249, 115, 22) ${((totalCB + totalHAB) / grandTotal) * 100}%, rgb(142, 156, 69) ${((totalCB + totalHAB) / grandTotal) * 100}%, rgb(34, 197, 94) ${((totalCB + totalHAB) / grandTotal) * 100}%, rgb(34, 197, 94) 100%)` : totalHAB > 0 ? `linear-gradient(to right, rgb(147, 51, 234) 0%, rgb(147, 51, 234) ${(totalCB / grandTotal) * 100}%, rgb(198, 83, 140) ${(totalCB / grandTotal) * 100}%, rgb(249, 115, 22) ${(totalCB / grandTotal) * 100}%, rgb(249, 115, 22) 100%)` : 'rgb(147, 51, 234)' }}></div>
                                    <div className="flex items-center gap-2 relative z-10">
                                        <span className="font-bold text-lg">TOTAL EARNINGS:</span>
                                    </div>
                                    <span className="text-2xl font-bold relative z-10">¬£{grandTotal.toLocaleString()}</span>
                                </div>

                                {tenantCount > 0 && (
                                    <div className="flex justify-between items-center py-3 px-4 rounded-lg border-4 bg-blue-50 border-blue-600 transition-all">
                                        <div className="flex items-center gap-2">
                                            <RefreshCw className="w-5 h-5 text-blue-600" />
                                            <span className="font-semibold text-gray-700">Recurring Income:</span>
                                        </div>
                                        <div className="text-right">
                                            <span className="text-xl font-bold text-blue-600">¬£{residualIncome.toFixed(2)}/m</span>
                                            <span className="block text-xs text-blue-500">(¬£{(residualIncome * 12).toLocaleString()}/yr)</span>
                                        </div>
                                    </div>
                                )}
                                {mode === 'opportunity' && (
                                    <div className={`rounded-lg border-2 py-3 px-4 transition-all ${qualifiesForFastStart ? 'bg-gradient-to-r from-purple-600 to-pink-600 border-purple-700' : 'bg-gray-100 border-gray-300'}`}>
                                        <div className="flex items-center gap-3 mb-3">
                                            {qualifiesForFastStart ? <div className="text-2xl">üîì</div> : <Lock className="w-5 h-5 text-gray-400 flex-shrink-0" />}
                                            <div className={`text-base font-bold ${qualifiesForFastStart ? 'text-white' : 'text-gray-400'}`}>New Revenue Streams Unlocked!</div>
                                        </div>
                                        <div className={`text-sm ${qualifiesForFastStart ? 'text-white' : 'text-gray-400'} space-y-1`}>
                                            <div className="flex justify-between">
                                                <span>Supporting Bonuses</span>
                                                <span className="font-bold">{qualifiesForFastStart ? `¬£${Math.round(totalCB / 2).toLocaleString()}` : '‚Äî'}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Mentoring Bonus</span>
                                                <span className="font-bold">{qualifiesForFastStart ? '¬£100' : '‚Äî'}</span>
                                            </div>
                                            <div className="flex justify-between">
                                                <span>Fast Start Mentoring</span>
                                                <span className="font-bold">{qualifiesForFastStart ? '¬£300' : '‚Äî'}</span>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {mode === 'track' && qualifiesForFastStart && (
                                    <div className="rounded-lg border-2 py-3 px-4 bg-gradient-to-r from-purple-600 to-pink-600 border-purple-700">
                                        <div className="flex items-center gap-3 mb-3">
                                            <div className="text-2xl">üîì</div>
                                            <div className="text-base font-bold text-white">Supporting New Partners - Worked Example</div>
                                        </div>
                                        <p className="text-sm text-white mb-3">Once you have 6 customers, supporting new partners to achieve their QD* Fast Start Bonus can benefit both you and them.</p>
                                        <div className="text-sm text-white space-y-2">
                                            <div className="flex justify-between items-center">
                                                <span>Their total earnings (just like you, above)</span>
                                                <span className="font-bold">¬£{grandTotal.toLocaleString()}</span>
                                            </div>
                                            <div className="flex justify-between items-center font-bold text-yellow-200">
                                                <span>Your supporting and Mentoring earnings (in this example)</span>
                                                <span>¬£{(Math.round(totalCB / 2) + 400).toLocaleString()}</span>
                                            </div>
                                            <div className="ml-4 space-y-1 text-white">
                                                <div className="flex items-center justify-between gap-2">
                                                    <div className="flex items-center gap-2">
                                                        <span className="text-base">ü§ù</span>
                                                        <span>Supporting Bonuses</span>
                                                    </div>
                                                    <span className="font-bold">¬£{Math.round(totalCB / 2).toLocaleString()}</span>
                                                </div>
                                                <div className="flex items-center justify-between gap-2">
                                                    <div className="flex items-center gap-2">
                                                        <span className="text-base">üéì</span>
                                                        <span>Mentoring Bonus</span>
                                                    </div>
                                                    <span className="font-bold">¬£100</span>
                                                </div>
                                                <div className="flex items-center justify-between gap-2">
                                                    <div className="flex items-center gap-2">
                                                        <TrendingUp className="w-4 h-4" />
                                                        <span>Fast Start Mentoring</span>
                                                    </div>
                                                    <span className="font-bold">¬£300</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        <div className="mt-4">
                            <button onClick={() => setShowResetConfirm(true)} className="w-full py-3 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition-colors">Reset Tracker</button>
                        </div>
                    </div>

                    {selectedCircle !== null && (
                        <div className="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50 p-4" onClick={() => setCurrentData({ ...currentData, selectedCircle: null })}>
                            <div className="bg-white rounded-xl p-6 shadow-2xl max-w-sm w-full animate-slideDown" onClick={(e) => e.stopPropagation()}>
                                <p className="text-sm font-semibold text-gray-900 mb-4 text-center">Customer {selectedCircle + 1}: Homeowner with<br className="sm:hidden" /> how many services?</p>
                                <div className="grid grid-cols-4 gap-2 mb-3">
                                    {[1, 2, 3, 4].map(num => {
                                        const cbAmount = num === 1 ? 50 : num === 2 ? 100 : num === 3 ? 250 : 300;
                                        return (
                                            <button key={num} onClick={() => setCustomerType('homeowner', num)} className={`py-4 px-2 border-2 rounded-lg font-medium transition-all ${customers[selectedCircle].type === 'homeowner' && customers[selectedCircle].services === num ? 'bg-purple-600 text-white border-purple-600' : 'bg-purple-50 border-purple-300 text-purple-700 hover:border-purple-600 hover:bg-purple-100'}`}>
                                                <div className="text-base font-bold">{num}</div>
                                                <div className="text-xs mt-1">(¬£{cbAmount})</div>
                                            </button>
                                        );
                                    })}
                                </div>
                                <p className="text-center text-sm text-gray-500 mb-3">or</p>
                                <button onClick={() => setCustomerType('renting')} className={`w-full py-3 px-3 border-2 rounded-lg font-medium transition-all mb-3 ${customers[selectedCircle].type === 'renting' ? 'bg-blue-600 text-white border-blue-600' : 'bg-blue-50 border-blue-300 text-blue-700 hover:border-blue-600 hover:bg-blue-100'}`}>
                                    <div className="text-base font-bold">Tenant/Renting</div>
                                    <div className="text-xs font-normal">(No customer bonus, just recurring income)</div>
                                </button>
                                {customers[selectedCircle].type !== null && (
                                    <button onClick={removeCustomer} className="w-full py-3 px-3 border-2 border-red-300 bg-red-50 text-red-700 rounded-lg font-medium hover:border-red-600 hover:bg-red-100 transition-all">Remove Customer</button>
                                )}
                            </div>
                        </div>
                    )}

                    {showResetConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-30 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-xl p-6 shadow-2xl max-w-sm w-full animate-slideDown">
                                <p className="text-lg font-semibold text-gray-900 mb-4 text-center">Are you sure?</p>
                                <p className="text-sm text-gray-600 mb-6 text-center">This will reset all customer data and cannot be undone.</p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowResetConfirm(false)} className="flex-1 py-2 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold rounded-lg transition-colors">No</button>
                                    <button onClick={resetTracking} className="flex-1 py-2 bg-red-500 hover:bg-red-600 text-white font-semibold rounded-lg transition-colors">Yes, Reset</button>
                                </div>
                            </div>
                        </div>
                    )}

                    {qdExpanded && (
                        <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4" onClick={() => setCurrentData({ ...currentData, qdExpanded: false })}>
                            <div className="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-6 text-white shadow-2xl max-w-md w-full animate-slideDown relative" onClick={(e) => e.stopPropagation()}>
                                <button
                                    onClick={() => setCurrentData({ ...currentData, qdExpanded: false })}
                                    className="absolute top-3 right-3 w-8 h-8 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full flex items-center justify-center transition-colors"
                                >
                                    <span className="text-white font-bold text-xl">√ó</span>
                                </button>
                                <div className="flex items-start gap-3">
                                    <div className="text-3xl">üîì</div>
                                    <div className="flex-1">
                                        <p className="text-lg font-bold mb-3">QD - Group Residual Income Unlocked!</p>
                                        <div className="flex items-start gap-2 text-base text-purple-100">
                                            <RefreshCw className="w-5 h-5 mt-0.5 flex-shrink-0" />
                                            <p>Earn ¬£0.30-¬£0.50 per customer introduced by partners in your team</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {qd6Expanded && !showIncomeStreamsPopup && !showPartnerPopup && (
                        <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4">
                            <div className="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-6 text-white shadow-2xl max-w-md w-full animate-slideDown relative">
                                <button
                                    onClick={() => setCurrentData({ ...currentData, qd6Expanded: false, showIncomeStreamsPopup: false, showPartnerPopup: false })}
                                    className="absolute top-3 right-3 w-8 h-8 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full flex items-center justify-center transition-colors"
                                >
                                    <span className="text-white font-bold text-xl">√ó</span>
                                </button>
                                <div className="flex items-start gap-3">
                                    <div className="text-3xl">üîì</div>
                                    <div className="flex-1">
                                        <p className="text-lg font-bold mb-3">Major Milestone!</p>
                                        <div className="bg-white bg-opacity-10 rounded-lg p-3 mb-3">
                                            <div className="flex items-center justify-between mb-2">
                                                <p className="text-base text-purple-100">Three income streams unlocked:</p>
                                                <button
                                                    onClick={(e) => {
                                                        e.stopPropagation();
                                                        setCurrentData({ ...currentData, showIncomeStreamsPopup: true, showPartnerPopup: false });
                                                    }}
                                                    className="px-3 py-1 bg-white bg-opacity-20 hover:bg-opacity-30 text-white font-semibold rounded-lg transition-colors text-xs"
                                                >
                                                    See more
                                                </button>
                                            </div>
                                            <ul className="text-sm text-purple-100 space-y-1 ml-4">
                                                <li className="flex items-center gap-2">
                                                    <RefreshCw className="w-4 h-4 flex-shrink-0" />
                                                    <span>Personal Residual Income</span>
                                                </li>
                                                <li className="flex items-center gap-2">
                                                    <span className="text-base flex-shrink-0">ü§ù</span>
                                                    <span>Supporting Bonuses</span>
                                                </li>
                                                <li className="flex items-center gap-2">
                                                    <span className="text-base flex-shrink-0">üéì</span>
                                                    <span>Mentoring Bonuses</span>
                                                </li>
                                            </ul>
                                        </div>
                                        <div className="flex items-center justify-between bg-white bg-opacity-10 rounded-lg p-3">
                                            <div className="flex items-center gap-2">
                                                <div className="w-6 h-6 rounded-full bg-yellow-400 border-2 border-yellow-600 flex items-center justify-center">
                                                    <span className="text-xs font-bold text-yellow-900">P</span>
                                                </div>
                                                <p className="text-base font-semibold text-yellow-200">Upgrade one customer to partner</p>
                                            </div>
                                            <button
                                                onClick={(e) => {
                                                    e.stopPropagation();
                                                    setCurrentData({ ...currentData, showPartnerPopup: true, showIncomeStreamsPopup: false });
                                                }}
                                                className="px-4 py-2 bg-yellow-400 hover:bg-yellow-500 text-yellow-900 font-bold rounded-lg transition-colors text-sm"
                                            >
                                                See how
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {qd6Expanded && showIncomeStreamsPopup && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4">
                            <div className="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg p-6 text-white shadow-2xl max-w-lg w-full animate-slideDown relative max-h-[90vh] overflow-y-auto">
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setCurrentData({ ...currentData, showIncomeStreamsPopup: false });
                                    }}
                                    className="absolute top-3 right-3 w-8 h-8 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full flex items-center justify-center transition-colors"
                                >
                                    <span className="text-white font-bold text-xl">√ó</span>
                                </button>
                                <div className="pr-8">
                                    <p className="text-xl font-bold mb-4">Three new income streams unlocked!</p>
                                    
                                    <div className="mb-4">
                                        <div className="flex items-center gap-2 mb-2">
                                            <RefreshCw className="w-5 h-5 text-purple-100" />
                                            <p className="text-lg font-bold">Personal residual income (PRI)</p>
                                        </div>
                                        <p className="text-sm text-purple-100 mb-2">A recurring percentage profit share of the customer's bill after a set period of time. Multiservice customers pay more residual income, typically:</p>
                                        <ul className="text-sm text-purple-100 ml-4 space-y-1">
                                            <li>‚Ä¢ Tenants ¬£2-3 a month</li>
                                            <li>‚Ä¢ Homeowners ¬£3-5 a month</li>
                                        </ul>
                                    </div>

                                    <div className="mb-4">
                                        <div className="flex items-center gap-2 mb-2">
                                            <span className="text-xl">ü§ù</span>
                                            <p className="text-lg font-bold">Supporting Customer Bonus up to ¬£150 per customer</p>
                                        </div>
                                        <p className="text-sm text-purple-100 mb-2">When supporting partners in your team to introduce homeowners you will earn 50% Customer Bonus</p>
                                        <div className="grid grid-cols-2 gap-x-4 gap-y-1 text-sm text-purple-100 ml-4">
                                            <div>‚Ä¢ 1 service ¬£25</div>
                                            <div>‚Ä¢ 3 services ¬£125</div>
                                            <div>‚Ä¢ 2 services ¬£50</div>
                                            <div>‚Ä¢ 4 services ¬£150</div>
                                        </div>
                                    </div>

                                    <div>
                                        <div className="flex items-center gap-2 mb-2">
                                            <span className="text-xl">üéì</span>
                                            <TrendingUp className="w-5 h-5 text-purple-100" />
                                            <p className="text-lg font-bold">Mentoring / Fast Start Bonus up to ¬£400 per Partner</p>
                                        </div>
                                        <div className="flex items-start gap-2 text-sm text-purple-100 mb-2">
                                            <span className="text-base flex-shrink-0">üéì</span>
                                            <p>When a partner you have introduced achieves QD* (6 customers, one partner) you earn ¬£100 Mentoring Bonus</p>
                                        </div>
                                        <div className="flex items-start gap-2 text-sm text-purple-100">
                                            <TrendingUp className="w-4 h-4 mt-0.5 flex-shrink-0" />
                                            <p>When they achieve QD* within 30 days you <span className="font-semibold">also</span> earn ¬£300 Fast Start Mentoring (total ¬£400)</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {qd6Expanded && showPartnerPopup && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-[100] p-4">
                            <div className="bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-lg p-6 shadow-2xl max-w-md w-full animate-slideDown relative">
                                <button
                                    onClick={(e) => {
                                        e.stopPropagation();
                                        setCurrentData({ ...currentData, showPartnerPopup: false });
                                    }}
                                    className="absolute top-3 right-3 w-8 h-8 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full flex items-center justify-center transition-colors"
                                >
                                    <span className="text-yellow-900 font-bold text-xl">√ó</span>
                                </button>
                                <div className="flex items-center justify-center gap-3">
                                    <div className="w-8 h-8 rounded-full bg-gray-200 border-2 border-gray-400 flex items-center justify-center">
                                        <span className="text-sm font-bold text-gray-500">P</span>
                                    </div>
                                    <span className="text-2xl text-yellow-900">‚Üí</span>
                                    <div className="w-8 h-8 rounded-full bg-yellow-400 border-2 border-yellow-600 flex items-center justify-center">
                                        <span className="text-sm font-bold text-yellow-900">P</span>
                                    </div>
                                    <p className="text-lg font-bold text-yellow-900">Upgrade just one customer to partner: just press it!</p>
                                </div>
                            </div>
                        </div>
                    )}
                    {showCelebration && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 p-4">
                            <div className="bg-white rounded-2xl p-8 max-w-md text-center animate-bounceOnce">
                                <div className="text-6xl mb-4">üéâ</div>
                                <h2 className="text-3xl font-bold text-purple-600 mb-4">Congratulations!</h2>
                                <p className="text-xl text-gray-700 mb-2">You have qualified for the</p>
                                <p className="text-4xl font-bold text-green-600 mb-4">¬£500 Fast Start Bonus!</p>
                            </div>
                        </div>
                    )}

                    {showWIP1 && (
                        <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4" onClick={() => setShowWIP1(false)}>
                            <div className="bg-white rounded-xl p-6 shadow-2xl max-w-md w-full animate-slideDown relative" onClick={(e) => e.stopPropagation()}>
                                <button
                                    onClick={() => setShowWIP1(false)}
                                    className="absolute top-3 right-3 w-8 h-8 bg-teal-100 hover:bg-teal-200 rounded-full flex items-center justify-center transition-colors border-2 border-teal-300"
                                >
                                    <span className="text-teal-900 font-bold text-xl">√ó</span>
                                </button>
                                <div className="text-center">
                                    <p className="text-lg font-bold text-teal-900 mb-1">Work In Progress 1: "You" On/Off</p>
                                    <p className="text-sm text-teal-700 mb-4">Suggestion (kinda!) by David P</p>
                                    <div className="bg-teal-500 rounded-lg p-4 border-2 border-teal-600">
                                        <p className="text-base text-white mb-2">This tool will toggle "You" customer On/Off</p>
                                        <p className="text-2xl mb-1">‚ÑπÔ∏è</p>
                                        <p className="text-sm text-white">hopefully self explanatory!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {showWIP2 && (
                        <div className="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 p-4" onClick={() => setShowWIP2(false)}>
                            <div className="bg-white rounded-xl p-6 shadow-2xl max-w-md w-full animate-slideDown relative" onClick={(e) => e.stopPropagation()}>
                                <button
                                    onClick={() => setShowWIP2(false)}
                                    className="absolute top-3 right-3 w-8 h-8 bg-teal-100 hover:bg-teal-200 rounded-full flex items-center justify-center transition-colors border-2 border-teal-300"
                                >
                                    <span className="text-teal-900 font-bold text-xl">√ó</span>
                                </button>
                                <div className="text-center">
                                    <p className="text-lg font-bold text-teal-900 mb-1">Work In Progress 2: "CB Picker" On/Off</p>
                                    <p className="text-sm text-teal-700 mb-4">suggestion by Moira J</p>
                                    <div className="bg-teal-500 rounded-lg p-4 border-2 border-teal-600">
                                        <p className="text-base text-white mb-2">This tool will toggle "CB Picker" On/Off</p>
                                        <p className="text-2xl mb-2">‚ÑπÔ∏è</p>
                                        <p className="text-sm text-white mb-3">Enable less confident partners to manually select individual services to automatically calculate the number of qualifying services (particularly useful if partners are less sure which service combo counts as a service)</p>
                                        <div className="bg-yellow-50 border-2 border-yellow-300 rounded-lg p-3 mt-3">
                                            <p className="text-xs font-bold text-gray-700 mb-1">NB: Tool Placement Notes</p>
                                            <p className="text-xs text-gray-600">When launched, this will sit on the existing modified (expanded) customer picker pop-up and will show 4 (maybe 5) buttons: Energy, Broadband, Mobile 1, Mobile 2, Insurance. In this mode when services are manually selected/auto calculated, homeowner/tenant renting status will subsequently need to be selected before the customer status is confirmed (separate button on the pop-up).</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<UWTracker />);
    </script>
</body>
</html>
